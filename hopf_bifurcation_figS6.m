% This code draws an Argand diagram showing the eigenvalues of the full
% coevolutionary system for different values of the lifespan. It shows that
% there is a Hopf bifurcation as lifespan increases. 

% Define parameter values:
lifespanvec=[4,4.5,5,5.5,6,6.5,7];
q=1;
f=1;
g=1;
tA=0;
beta0=10;
rJ=0;
rA=0;
a0=5;
c1=0.275;
c2=3;
gamma=0;
finP=10;
hostmutationprob=1/21;
phiH=hostmutationprob;
phiP=1-hostmutationprob;
initvec=[0.07,0.07,0.02,0.02];
orig_tmax=100;

% Set up vectors to use later:
realvec=NaN(length(lifespanvec),2);
imagvec=NaN(length(lifespanvec),2);

% For each value of the lifespan, find the eigenvalues of the full
% coevolutionary system:
parfor i=1:length(lifespanvec)
    disp(i)
    bJ=1/lifespanvec(i);
    bA=1/lifespanvec(i);

    % Find co-singular strategy:
    [tJvec,alphavec,~,~]=JL_singstrat_function(q,f,bJ,bA,g,tA,beta0,rJ,rA,a0,c1,c2,gamma,finP);
    tJ=tJvec(end);
    alpha=alphavec(end);
    
    % Define second derivatives of the fitness functions:
    eps=1e-2;
    aval=a0*(1-c1*(1-exp(c2*tJ))/(1-exp(c2)));
    avalupH=a0*(1-c1*(1-exp(c2*(tJ+eps)))/(1-exp(c2)));
    avaldownH=a0*(1-c1*(1-exp(c2*(tJ-eps)))/(1-exp(c2)));
    avalupP=a0*(1-c1*(1-exp(c2*(tJ)))/(1-exp(c2)));
    avaldownP=a0*(1-c1*(1-exp(c2*(tJ)))/(1-exp(c2)));
    [SJ,SA,IJ,IA,~]=endemic_equilibrium_function(tJ,tA,rJ,rA,g,aval,q,beta0,bJ,bA,f,alpha,gamma,initvec,orig_tmax);
    [SJupH,SAupH,IJupH,IAupH,~]=endemic_equilibrium_function(tJ+eps,tA,rJ,rA,g,avalupH,q,beta0,bJ,bA,f,alpha,gamma,initvec,orig_tmax);
    [SJdownH,SAdownH,IJdownH,IAdownH,~]=endemic_equilibrium_function(tJ-eps,tA,rJ,rA,g,avaldownH,q,beta0,bJ,bA,f,alpha,gamma,initvec,orig_tmax);
    [SJupP,SAupP,IJupP,IAupP,~]=endemic_equilibrium_function(tJ,tA,rJ,rA,g,avalupP,q,beta0,bJ,bA,f,alpha+eps,gamma,initvec,orig_tmax);
    [SJdownP,SAdownP,IJdownP,IAdownP,~]=endemic_equilibrium_function(tJ,tA,rJ,rA,g,avaldownP,q,beta0,bJ,bA,f,alpha-eps,gamma,initvec,orig_tmax);
    deriv2H=- (2*a0*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IA + IJ + SA + SJ) - 1)*(alpha*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1)) + alpha*beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))^2*(g*(beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1))^2)/(((bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))^3 - (a0*c1*c2^2*exp(c2*tJ)*(q*(IA + IJ + SA + SJ) - 1)*(g*(beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)))/((((bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))*(exp(c2) - 1)) - (2*a0*g*(alpha*(bA + gamma - alpha*(tA - 1)) - alpha*beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IA + IJ + SA + SJ) - 1)*(alpha*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1)) + alpha*beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)))/(((bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))^2 - (2*a0*c1*c2*g*exp(c2*tJ)*(alpha*(bA + gamma - alpha*(tA - 1)) - alpha*beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(q*(IA + IJ + SA + SJ) - 1))/((((bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))*(exp(c2) - 1)) - (2*a0*c1*c2*exp(c2*tJ)*(q*(IA + IJ + SA + SJ) - 1)*(alpha*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1)) + alpha*beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(g*(beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)))/((((bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(bA - beta0*(IA*alpha^(1/2) + IJ*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IA*alpha^(1/2) + IJ*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))^2*(exp(c2) - 1));
    deriv2P=(SJ*beta0*(rJ - 1)*(g/(4*alpha^(3/2)) + (bA + gamma - alpha*(tA - 1))/(4*alpha^(3/2)) + (tA - 1)/alpha^(1/2)) + (SA*beta0*(rA - 1)*(tJ - 1))/alpha^(1/2) + (SA*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))/(4*alpha^(3/2)))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))) - (2*(tA - 1)^2*(SJ*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SA*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))^3*(bJ + g + gamma - alpha*(tJ - 1))) - (2*(tJ - 1)^2*(SJ*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SA*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))^3) - (2*(tA - 1)*(SJ*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) - SA*alpha^(1/2)*beta0*(rA - 1)*(tJ - 1) + (SA*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))/(2*alpha^(1/2))))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma - alpha*(tJ - 1))) - (2*(tJ - 1)*(SJ*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) - SA*alpha^(1/2)*beta0*(rA - 1)*(tJ - 1) + (SA*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))/(2*alpha^(1/2))))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))^2) - (2*(tA - 1)*(tJ - 1)*(SJ*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SA*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma - alpha*(tJ - 1))^2);
    cderivH1=((a0*g*(alpha*(bA + gamma - alpha*(tA - 1)) - alpha*beta0*f*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAdownH + IJdownH + SAdownH + SJdownH) - 1))/(((bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))^2*(rA - 1)*(rJ - 1))) - (a0*g*(alpha*(bA + gamma - alpha*(tA - 1)) - alpha*beta0*f*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAupH + IJupH + SAupH + SJupH) - 1))/(((bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))^2*(rA - 1)*(rJ - 1))) + (a0*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAdownH + IJdownH + SAdownH + SJdownH) - 1)*(alpha*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1)) + alpha*beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(g*(beta0*f*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1))*(bJ + g - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1)))/(((bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))^2 - (a0*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAupH + IJupH + SAupH + SJupH) - 1)*(alpha*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1)) + alpha*beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(g*(beta0*f*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1))*(bJ + g - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1)))/(((bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))^2 + (a0*c1*c2*exp(c2*tJ)*(q*(IAdownH + IJdownH + SAdownH + SJdownH) - 1)*(g*(beta0*f*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1)))/((((bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(bA - beta0*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAdownH*alpha^(1/2) + IJdownH*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))*(exp(c2) - 1)) - (a0*c1*c2*exp(c2*tJ)*(q*(IAupH + IJupH + SAupH + SJupH) - 1)*(g*(beta0*f*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)) - (bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*f*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(rJ - 1)) + beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1)))/((((bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1)) + beta0*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))*(bJ + g - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rJ - 1)) + gamma*(beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(bA - beta0*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - alpha*(tA - 1)) + beta0^2*gamma*(IAupH*alpha^(1/2) + IJupH*alpha^(1/2))^2*(rA - 1)*(rJ - 1)))*(exp(c2) - 1)))/(2*eps);
    cderivH2=((a0*g*((alpha - eps)*(bA + gamma - (alpha - eps)*(tA - 1)) - beta0*f*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(alpha - eps)*(rA - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAdownP + IJdownP + SAdownP + SJdownP) - 1))/(((bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha - eps)*(tA - 1))*(bJ + g + gamma - (alpha - eps)*(tJ - 1)) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha - eps)*(tJ - 1)))*(bJ + g - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1)) + gamma*(beta0^2*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - (alpha - eps)*(tA - 1)))) - (a0*g*((alpha + eps)*(bA + gamma - (alpha + eps)*(tA - 1)) - beta0*f*(alpha + eps)*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAupP + IJupP + SAupP + SJupP) - 1))/(gamma*(beta0^2*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)*(bA + gamma - (alpha + eps)*(tA - 1))) + ((bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha + eps)*(tA - 1))*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) + beta0*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha + eps)*(tJ - 1)))*(bJ + g - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1))) - (a0*((bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(alpha + eps)*(bA + gamma - (alpha + eps)*(tA - 1)) + beta0*gamma*(alpha + eps)*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(g*(beta0*f*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) - (bA + gamma - (alpha + eps)*(tA - 1))*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) + beta0*f*(bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)) + beta0*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAupP + IJupP + SAupP + SJupP) - 1)*(bJ + g - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)))/(gamma*(beta0^2*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)*(bA + gamma - (alpha + eps)*(tA - 1))) + ((bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha + eps)*(tA - 1))*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) + beta0*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha + eps)*(tJ - 1)))*(bJ + g - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)))^2 + (a0*(g*(beta0*f*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(rJ - 1) - (bA + gamma - (alpha - eps)*(tA - 1))*(bJ + g + gamma - (alpha - eps)*(tJ - 1)) + beta0*f*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha - eps)*(tJ - 1))) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1))*((c1*(exp(c2*tJ) - 1))/(exp(c2) - 1) - 1)*(q*(IAdownP + IJdownP + SAdownP + SJdownP) - 1)*((alpha - eps)*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha - eps)*(tA - 1)) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(alpha - eps)*(rA - 1))*(bJ + g - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1)))/(((bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha - eps)*(tA - 1))*(bJ + g + gamma - (alpha - eps)*(tJ - 1)) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha - eps)*(tJ - 1)))*(bJ + g - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1)) + gamma*(beta0^2*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - (alpha - eps)*(tA - 1))))^2 - (a0*c1*c2*exp(c2*tJ)*(g*(beta0*f*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) - (bA + gamma - (alpha + eps)*(tA - 1))*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) + beta0*f*(bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)) + beta0*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1))*(q*(IAupP + IJupP + SAupP + SJupP) - 1))/((exp(c2) - 1)*(gamma*(beta0^2*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)*(bA + gamma - (alpha + eps)*(tA - 1))) + ((bA - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha + eps)*(tA - 1))*(bJ + g + gamma - (alpha + eps)*(tJ - 1)) + beta0*gamma*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha + eps)*(tJ - 1)))*(bJ + g - beta0*(IAupP*(alpha + eps)^(1/2) + IJupP*(alpha + eps)^(1/2))*(rJ - 1)))) + (a0*c1*c2*exp(c2*tJ)*(g*(beta0*f*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(rJ - 1) - (bA + gamma - (alpha - eps)*(tA - 1))*(bJ + g + gamma - (alpha - eps)*(tJ - 1)) + beta0*f*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha - eps)*(tJ - 1))) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1))*(q*(IAdownP + IJdownP + SAdownP + SJdownP) - 1))/((exp(c2) - 1)*(((bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(bA + gamma - (alpha - eps)*(tA - 1))*(bJ + g + gamma - (alpha - eps)*(tJ - 1)) + beta0*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1)*(bJ + g + gamma - (alpha - eps)*(tJ - 1)))*(bJ + g - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rJ - 1)) + gamma*(beta0^2*gamma*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))^2*(rA - 1)*(rJ - 1) + beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(bA - beta0*(IAdownP*(alpha - eps)^(1/2) + IJdownP*(alpha - eps)^(1/2))*(rA - 1))*(rJ - 1)*(bA + gamma - (alpha - eps)*(tA - 1))))))/(2*eps);
    cderivP1=((SJdownP*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) - SAdownP*alpha^(1/2)*beta0*(rA - 1)*(tJ - 1) + (SAdownP*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))/(2*alpha^(1/2)))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))) - (SJupP*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) - SAupP*alpha^(1/2)*beta0*(rA - 1)*(tJ - 1) + (SAupP*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1)))/(2*alpha^(1/2)))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))) + ((tA - 1)*(SJdownP*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAdownP*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma - alpha*(tJ - 1))) - ((tA - 1)*(SJupP*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAupP*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma - alpha*(tJ - 1))) + ((tJ - 1)*(SJdownP*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAdownP*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))^2) - ((tJ - 1)*(SJupP*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAupP*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(tJ - 1))))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(tJ - 1))^2))/(2*eps);
    cderivP2=-((SJupH*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) + (SAupH*beta0*(rA - 1)*(bJ + g + gamma - alpha*(eps + tJ - 1)))/(2*alpha^(1/2)) - SAupH*alpha^(1/2)*beta0*(rA - 1)*(eps + tJ - 1))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(eps + tJ - 1))) - (SJdownH*beta0*(rJ - 1)*(g/(2*alpha^(1/2)) + (bA + gamma - alpha*(tA - 1))/(2*alpha^(1/2)) - alpha^(1/2)*(tA - 1)) + SAdownH*alpha^(1/2)*beta0*(rA - 1)*(eps - tJ + 1) + (SAdownH*beta0*(rA - 1)*(bJ + g + gamma + alpha*(eps - tJ + 1)))/(2*alpha^(1/2)))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma + alpha*(eps - tJ + 1))) - ((SJdownH*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAdownH*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma + alpha*(eps - tJ + 1)))*(tA - 1))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma + alpha*(eps - tJ + 1))) + ((SJupH*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAupH*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(eps + tJ - 1)))*(tA - 1))/((bA + gamma - alpha*(tA - 1))^2*(bJ + g + gamma - alpha*(eps + tJ - 1))) + ((SJupH*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAupH*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma - alpha*(eps + tJ - 1)))*(eps + tJ - 1))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma - alpha*(eps + tJ - 1))^2) + ((SJdownH*beta0*(alpha^(1/2)*g + alpha^(1/2)*(bA + gamma - alpha*(tA - 1)))*(rJ - 1) + SAdownH*alpha^(1/2)*beta0*(rA - 1)*(bJ + g + gamma + alpha*(eps - tJ + 1)))*(eps - tJ + 1))/((bA + gamma - alpha*(tA - 1))*(bJ + g + gamma + alpha*(eps - tJ + 1))^2))/(2*eps);
    
    % Define total population densities:
    host_density=SJ+SA+IJ+IA;
    parasite_density=IJ+IA;
    
    % Form Jacobian matrix:
    J1=phiH*host_density*(deriv2H+cderivH1);
    J2=phiH*host_density*cderivH2;
    J3=phiP*parasite_density*cderivP2;
    J4=phiP*parasite_density*(deriv2P+cderivP1);
    J=[J1,J2;J3,J4];
    
    % Find the eigenvalues and their real and imaginary parts:
    eigs=eig(J);
    realvec(i,:)=real(eigs);
    imagvec(i,:)=imag(eigs);
    
end

% Plot the eigenvalues on an Argand diagram:
hold on
h1=plot(realvec(1,:),imagvec(1,:),'x','color',[1,0,0],'linewidth',10);
h2=plot(realvec(2,:),imagvec(2,:),'x','color',[1,0.5,0],'linewidth',10);
h3=plot(realvec(3,:),imagvec(3,:),'x','color',[0.9,0.9,0.2],'linewidth',10);
h4=plot(realvec(4,:),imagvec(4,:),'x','color',[0,0.5,0],'linewidth',10);
h5=plot(realvec(5,:),imagvec(5,:),'x','color',[0,0,1],'linewidth',10);
h6=plot(realvec(6,:),imagvec(6,:),'x','color',[0.5,0,1],'linewidth',10);
h7=plot(realvec(7,:),imagvec(7,:),'x','color',[0.9,0,0.9],'linewidth',10);

plot(zeros(100,1),linspace(-2,2,100),'k','linewidth',2);
plot(linspace(-2,2,100),zeros(100,1),'k','linewidth',2);
xlim([-0.01,0.01])
ylim([-0.01,0.01])
xlabel("Real part of eigenvalues")
ylabel("Imaginary part of eigenvalues")
leg=legend([h1,h2,h3,h4,h5,h6,h7],{'4','4.5','5','5.5','6','6.5','7'});
leg.Title.Visible='on';
title(leg,'Lifespan')
axis square
box on
